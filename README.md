# ACI IT: Лабораторная №1:  Основы скриптинга для автоматизации

**Выполнил: Соколов Даниил**\
**Группа: I2302**

# Задание 1

## «CLI‑ассистент: приветствие, валидация и мини‑отчёт о системе»

### Цель

Освоить ввод/вывод, переменные, условия, простые циклы, подстановку команд.

### Что сделать

Написать скрипт `cli_assistant.sh`, который:

1. Спрашивает имя пользователя и (необязательно) его отдел/группу
2. Валидирует ввод (пустые значения — повторный запрос до 3 попыток).
3. Выводит мини‑отчёт:
    - текущая дата,
    - имя хоста,
    - время аптайма,
    - свободное место на `/`,
    - количество пользователей, вошедших в систему.
4. Итоговая строка: «Здравствуйте, <Имя> (<Отдел|не указан>)!».

### Требования

- Shebang `#!/bin/bash`.
- Валидация пустого ввода с максимум 3 попытками (после — вежливый выход с кодом `1`).
- Использование командной подстановки `$(...)`.
- Только стандартные утилиты.

### Выполнение


- Создал файл скрипт и с помощью терминала и текстового редактора nano заполнил его
```bash
nano cli_assistant.sh
```

![img](/images/img_1.png)

- Делаю файл исполняемым
```bash
chmod +x cli_assistant.sh
```

#### Пример тестирования

- Запуск скрипта:
```bash
./cli_assistant.sh
```

- Ввод имени и отдела и реузультат:

![img](/images/img_2.png)

- Если имя не введено 3 раза подряд:
- Скрипт завершится с кодом 1.

![img](/images/img_3.png)

Код приложен в репозитории `cli_assistant.sh`

# Задание 2

## «Резервное копирование каталога с логированием и ротацией»

### Цель

Отработать аргументы скрипта, работу с файлами/путями, условия, архивирование, коды возврата и логирование.

### Что сделать

Написать скрипт `backup_rot.sh`, который:

- Принимает аргументы:
    1. Обязательный путь к каталогу‑источнику (например, `/home/student/data`).
    2. Необязательный путь к каталогу для бэкапов (по умолчанию `~/backups`).
        
- Проверяет, что источник существует и это каталог; создаёт каталог бэкапов при необходимости.
- Создаёт архив `tar.gz` с именем по шаблону:  
    `backup_<basename источника>_<YYYYMMDD_HHMMSS>.tar.gz`
- Пишет лог в `backup.log` в каталоге бэкапов (время, имя архива, размер, код возврата).
- Возвращает код `0` при успехе, `≠0` при ошибках ввода/архивации.

### Примеры

```shell
$ ./backup_rot.sh 
~/projects/app 
$ ./backup_rot.sh /var/www /mnt/storage/backups 5
```

### Требования
- Защита от пробелов в путях (кавычки при `tar`, `mv`, `rm`).
- Проверка доступности записи в каталог бэкапов.

### Пример лога (фрагмент)

```shell
2025-08-23T14:45:12 SRC=/var/www DST=/mnt/storage/backups \ FILE=backup_www_20250823_144512.tar.gz SIZE=128M STATUS=0`
```

### Выполнение

Проверяю, что создался каталог ~/backups
Архив появился с правильным именем.
В backup.log есть запись со STATUS=0.

![img](/images/img_4.png)

![img](/images/img_5.png)

![img](/images/img_6.png)

Проверяю, что архив создаётся именно в `/home/socolov/Desktop/lab/`

![img](/images/img_7.png)

Проверяю на ошибки

![img](/images/img_8.png)

![img](/images/img_9.png)

![img](/images/img_10.png)

Код приложен в репозитории `backup_rot.sh`

# Задание 3
## «Мониторинг дискового пространства»

### Цель

Закрепить циклы, условия, работу с системными командами (`df`, `awk`), аргументы и коды возврата.

### Что нужно сделать

Написать скрипт `disk_monitor.sh`, который:

1. Принимает аргументы:
    - путь к файловой системе (например, `/` или `/home`),
    - необязательный порог заполнения (%) — по умолчанию 80.
2. Проверяет, что путь существует.
3. С помощью `df -h` получает процент использования.
4. Выводит:
    - текущую дату/время,
    - путь и процент занятости,
    - сообщение «OK» если меньше порога, иначе «WARNING: диск почти заполнен!».
5. Возвращает код:
    - `0`, если всё в норме,
    - `1`, если превышен порог,
    - `2`, если ошибка (например, путь не найден).

```shell
$ ./disk_monitor.sh / 75
2025-08-23 14:55:12
Путь: /
Использовано: 42%
Статус: OK
```

### Выполнение

Код приложен в репозитории `disk_monitor.sh`

![img](/images/img_11.png)